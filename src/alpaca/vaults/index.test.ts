import { getPositions } from ".";
import { parseVaultInput } from "./worker";
import bar from './transactions.json'

describe('ðŸ¦™ Vault', () => {
  beforeEach(() => {
    jest.spyOn(console, 'warn').mockImplementation(() => { });
  });

  it('can get positions', async () => {
    const positions = await getPositions('0x8155430e4860e791aeddb43e4764d15de7e0def1')

    expect(positions).toBeDefined()
  }, 100000);

  it('can get parseVaultInput', async () => {

    let foos = bar.result.map(e => {
      if (e.from_address !== '0x8155430e4860e791aeddb43e4764d15de7e0def1') return null

      return {
        ...parseVaultInput(e.input),
        from_address: e.from_address,
        to_address: e.to_address,
        block_timestamp: e.block_timestamp,
        block_number: e.block_number,
      }
    }).filter(e => e)
    // parseVaultInput('0xd72ef7710000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ecb008f4741465f9f169ec11a50aa8871e423f3300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c000000000000000000000000000000000000000000000000000000000000000a00000000000000000000000005f94f61095731b669b30ed1f3f4586bbb51f4001000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000de0b6b3a76400000000000000000000000000000000000000000000000000001ab46fcac70a2a66')
    console.log(foos)
    expect(foos).toBeDefined()
  }, 100000);
})
